#+TITLE: Intro Hacking Binarios en Linux
#+AUTHOR: ZenTauro
#+SETUPFILE: https://fniessen.github.io/org-html-themes/setup/theme-readtheorg.setup

[[./img.png]]
* Sesiones
  Inscripciones en Delegación
 | Contenido | Día                    | Mañana  | Tarde   |
 |-----------+------------------------+---------+---------|
 | Intro     | Martes 12 Febrero 2019 | 12 - 14 | 15 - 17 |
 | Taller    | Martes 19 Febrero 2019 | 12 - 14 | 15 - 17 |

* Introducción
  El cursillo consistirá en dos sesiones, una de introducción mas
  teórica y otra de un taller donde utilizaremos los conocimientos
  aprendidos.

  Se explicarán a grandes rasgos como funcionan los archivos ejecutables
  en Linux, las distintas secciones que tienen y como se distribuyen
  en memoria. Una vez explicado se procederá a establecer una relación
  entre el código en C y el lenguaje de ensamblador para poder ver
  las convenciones que existen y más tarde poder aprovecharnos de
  algunas de las vulnerabilidades más comunes.

  Se utilizarán las herramientas de software libre radare2 y pwndbg
  para la inspección y "depuración" de los binarios. Se recomienda
  tener una distro basada en Debian, como Ubuntu, con el paquete
  build-essential instalado. También es deseable tener tanto [[https://rada.re/r/][radare2]]
  como [[https://github.com/pwndbg/pwndbg][pwndbg]] para ahorrar tiempo y empezar el taller lo antes posible.

* Requisitos previos
  - Saber un poco de programación en C
  - Tener un Linux instalado (ya sea en maquina virtual o disco)
  - Ganas de aprender
  - Clonar los repositorios

* Instalaciones
** Herramientas de desarrollo
  #+BEGIN_SRC sh
    sudo apt update
    sudo apt upgrade
    sudo apt install build-essential git
  #+END_SRC

** Pwndbg
  #+BEGIN_SRC sh
    git clone https://github.com/pwndbg/pwndbg.git
    cd pwndbg
    ./setup.sh
    cd ..
  #+END_SRC

** Radare2
  #+BEGIN_SRC sh
    git clone https://github.com/radare/radare2.git
    cd radare2
    sys/install.sh
    cd ..
  #+END_SRC

** Archivos para el taller
  #+BEGIN_SRC sh
    mkdir talleres
    cd talleres
    https://github.com/ZenTauro/intro_exploiting_binarios.git
    cd ..
  #+END_SRC

* Como compilar binarios para análisis
  En el directorio donde estén los archivos .c ejecutamos:
  (tenemos que sustituir ejemplo.c con el nombre del programa)
  #+BEGIN_SRC sh
  gcc -m32 -fno-stack-protector -O0 ejemplo.c -o ejemplo
  #+END_SRC

* Radare2 cheatsheet
  [[https://github.com/radare/radare2/blob/master/doc/intro.md][CheatSheet oficial]]
** Posicionamiento
   | Comando     | Descripción                    |
   |-------------+--------------------------------|
   | s dirección | Mover el cursor a la dirección |
   | s-n         | Mover n bytes hacia atrás      |
   | s-          | Deshacer ~s~                   |
   | s+          | Rehacer ~s~                    |

** Información

   | Comando | Descripción                                 |
   |---------+---------------------------------------------|
   | i       | Información                                 |
   | iS=     | Información Secciones del Binario con ASCII |
   | iz      | Información strings en sección .data        |
   | iI      | Información sobre el archivo                |
   | ii      | Simbolos importados                         |
   | il      | Librerías enlazadas                         |

** Análisis
   | Comando | Descripción                              |
   |---------+------------------------------------------|
   | aaa     | Analisis nivel 3                         |
   | axt     | Buscar referencias a la dirección actual |
   | afi     | Información sobre función actual         |

** Print
   | Comando | Descripción                   |
   |---------+-------------------------------|
   | pdf     | Enseñar Función desensamblada |
   | p=      | ASCII entropía                |

* Enlaces interesantes
  - [[https://www.megabeets.net][MegaBeets]]
  - [[https://liveoverflow.com/index.html][Live Overflow]]
